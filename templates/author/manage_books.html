<!DOCTYPE html>
<html>
  <head>
    <title>Manage Books</title>
    <style>
      body {
        font-family: 'Arial', sans-serif;
        background-color: #fff9c4; /* Light yellow background */
        margin: 0;
        padding: 20px;
        color: #555;
      }

      h1,
      h2 {
        color: #ffa000; /* Amber color for headings */
        text-align: center;
        margin-bottom: 20px;
      }

      form {
        background-color: #ffecb3; /* Lighter yellow for forms */
        padding: 20px;
        margin-bottom: 20px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* Soft shadow for depth */
        border-radius: 10px;
      }

      label {
        display: block;
        margin-top: 20px;
        margin-bottom: 5px;
      }

      input[type='text'],
      select,
      input[type='file'],
      button {
        width: 100%;
        padding: 8px;
        margin-bottom: 10px; /* Adjusted spacing */
        border-radius: 5px;
        border: 1px solid #ccc;
        box-sizing: border-box;
        transition: box-shadow 0.3s ease-in-out; /* Transition for shadow */
      }

      input[type='text']:hover,
      select:hover,
      input[type='file']:hover {
        box-shadow: 0 0 8px rgba(255, 165, 0, 0.8); /* Orange glow on hover */
      }

      button {
        background-color: #ff9800; /* Orange color for buttons */
        color: white;
        border: none;
        cursor: pointer;
        transition: background-color 0.3s ease, transform 0.2s ease; /* Smooth transition for hover */
      }

      button:hover {
        background-color: #f57c00; /* Darker orange on hover */
        transform: translateY(-2px); /* Slight raise effect */
      }

      #editFields,
      #deleteField {
        margin-top: 20px; /* Added spacing */
      }

      #deleteField button {
        background-color: #d32f2f; /* Red color for delete button */
      }

      #deleteField button:hover {
        background-color: #b71c1c; /* Darker red on hover */
      }

      .back-button {
        display: block;
        width: fit-content;
        margin: 0 auto 20px; /* Centered and added margin at the bottom */
        padding: 10px 20px;
        background-color: #ffa000; /* Amber color to match headings */
        color: white;
        text-decoration: none;
        border-radius: 20px; /* Consistent with button styles */
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); /* Light shadow for depth */
      }

      .back-button:hover {
        background-color: #fb8c00; /* Slightly darker on hover */
        transform: translateY(-2px); /* Consistent raise effect */
      }
    </style>
    <script>
      function toggleEditFields() {
        var actionSelect = document.getElementById('action');
        var editFields = document.getElementById('editFields');
        var deleteField = document.getElementById('deleteField');

        if (actionSelect.value === 'edit_book') {
          editFields.style.display = 'block';
          deleteField.style.display = 'none';
        } else if (actionSelect.value === 'delete_book') {
          editFields.style.display = 'none';
          deleteField.style.display = 'block';
        }
      }

      // Ensure the edit fields are hidden initially
      window.onload = function () {
        var editFields = document.getElementById('editFields');
        var deleteField = document.getElementById('deleteField');
        editFields.style.display = 'block'; // Show edit fields by default
        deleteField.style.display = 'none'; // Hide delete field by default
      };
    </script>
  </head>
  <body>
    <script>
      window.addEventListener('DOMContentLoaded', (event) => {
          let errorMessage = '{{ get_flashed_messages(category_filter=["error"])[0] if get_flashed_messages(category_filter=["error"]) }}';
          if (errorMessage && errorMessage.includes('Error')) {
              alert(errorMessage);
          }
          let successMessage = '{{ get_flashed_messages(category_filter=["success"])[0] if get_flashed_messages(category_filter=["success"]) }}';
          if (successMessage && successMessage.includes('Book')) {
              alert(successMessage);
          }
      });
  </script>
    <h1>Manage Books for {{ author_name }}</h1>
    <form method="POST" enctype="multipart/form-data">
      <input type="hidden" name="author_name" value="{{ author_name }}" />
      <label for="book">Choose a book:</label>
      <select id="book" name="book_id">
        {% for book in author_books %}
        <option value="{{ book.id }}">{{ book.name }}</option>
        {% endfor %}
      </select>
      <label for="action">Select action:</label>
      <select id="action" name="action" onchange="toggleEditFields()">
        <option value="edit_book" selected>Edit Book</option>
        <option value="delete_book">Delete Book</option>
      </select>
      <div id="editFields">
        <label for="name">New Book Name:</label>
        <input type="text" id="name" name="name" value="{{ current_name }}" />
        <label for="section_id">Select New Section:</label>
        <select id="section_id" name="section_id">
          {% for section in sections %}
              <option value="{{ section.id }}" {% if section.id == current_section_id %}selected{% endif %}>{{ section.name }}</option>
          {% endfor %}
      </select>
        <label for="price">New Price:</label>
        <input type="number" id="price" name="price" min="0" step="1" value="{{ current_price }}" />
        <label for="content">New Content:</label>
        <input type="file" id="content" name="content" />
      </div>

      <div id="deleteField" style="display: none">
        <label>Are you sure you want to delete this book?</label>
        <button type="button" onclick="deleteBook()">Delete Book</button>
      </div>
      <button type="submit">Perform Action</button>
    </form>
    <h2>Add Book</h2>
    <form method="POST" enctype="multipart/form-data">
      <label for="newBookName">Book Name:</label>
      <input type="text" id="newBookName" name="newBookName" required />

      <label for="newBookSection">Select Section:</label>
      <select id="newBookSection" name="newBookSection">
        {% for section in sections %}
        <option value="{{ section.id }}">{{ section.name }}</option>
        {% endfor %}
      </select>

      <label for="newBookContent">Upload Book Content:</label>
      <input
        type="file"
        id="newBookContent"
        name="newBookContent"
        required
        accept=".pdf"
      />
      <label for="newBookPrice">Price:</label>
      <input
        type="number"
        id="newBookPrice"
        name="newBookPrice"
        min="0"
        step="1"
        required
      />
      <input
        type="hidden"
        id="authorName"
        name="authorName"
        value="{{ author_name }}"
      />

      <button type="submit" style="margin-top: 10px">Add Book</button>
    </form>
    <a
      href="{{ url_for('author_page', author_name=author_name) }}"
      class="back-button"
      >Back to Author</a
    >
  </body>
</html>
